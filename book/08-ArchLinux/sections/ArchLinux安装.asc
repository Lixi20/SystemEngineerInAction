=== ArchLinux 安装

==== 建立硬盘分区

[source, bash]
cfdisk

步骤一：

image::cfdisk-1.png[]

步骤二：

image::cfdisk-2.png[]

步骤三：

image::cfdisk-3.png[]

==== 格式化分区

文件系统格式化

[source, bash]
mkfs.ext4 /dev/sda1

交换格式化

[source, bash]
----
mkswap /dev/sda2

swapon /dev/sda2
----

==== 挂载分区

[source, bash]
mount /dev/sda1 /mnt

==== 选择镜像源

更换为国内的镜像源

[source, bash]
----
cat << EOF > /etc/pacman.d/mirrorlist
# tsinghua
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/\$repo/os/\$arch
EOF
----

==== 安装必须的软件包

使用 pacstrap 脚本，安装 base 软件包

[source, bash]
pacstrap /mnt base

==== 配置系统

用以下命令生成 fstab 文件 (用 -U 或 -L 选项设置UUID 或卷标)

[source, bash]
genfstab -U /mnt >> /mnt/etc/fstab

==== Chroot
Change root 到新安装的系统

[source, bash]
arch-chroot /mnt

==== 时区

[source, bash]
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

运行 hwclock 以生成 /etc/adjtime

[source, bash]
hwclock  --systohc

==== 本地化语言支持

[source, bash]
----
echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen +
echo "zh_CN.GB18030 GB18030" >> /etc/locale.gen +
echo "zh_CN.GBK GBK" >> /etc/locale.gen +
echo "zh_CN.UTF-8 UTF-8" >> /etc/locale.gen +
echo "zh_CN GB2312" >> /etc/locale.gen
----

生成locale

[source, bash]
locale-gen

Tip: 将系统 locale 设置为 en_US.UTF-8，系统的 Log 就会用英文显示

[source, bash]
echo "LANG=zh_CN.UTF-8" > /etc/locale.conf

==== 键盘布局

[source, bash]
echo "KEYMAP=us" > /etc/vconsole.conf

==== 网络 
添加对应的信息到 hosts

[source, bash]
vim /etc/hosts

image::hosts.png[]

==== 设置root密码

[source, bash]
passwd

==== 创建用户

新增用户

[source, bash]
useradd -m ylighgh

修改用户密码

[source, bash]
passwd ylighgh

用户授予权限

[source, bash]
usermod -aG wheel,audio,video,optical,storage ylighgh

检查权限

[source, bash]
groups ylighgh

对vanabel用户提权, 使得可以使用sudo来获得root权限 

[source, bash]
pacman -S sudo

或

[source, bash]
visudo

image::visudo.png[]

==== 安装引导器(GRUB)

[source, bash]
----
pacman -S grub
grub-install /dev/sda
pacman -S linux linux-headers linux-lts linux-lts-headers
grub-mkconfig -o /boot/grub/gurb.cfg
----

==== 卸载分区并重启

输入 `exit`，退回到live模式。然后执行：

[source, bash]
----
umount -R /mnt
poweroff
----

安装完成，重启进入系统。

