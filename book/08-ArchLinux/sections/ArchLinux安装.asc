=== ArchLinux 安装

==== 建立硬盘分区

[source, bash]
cfdisk

步骤一：

image::cfdisk-1.png[]

步骤二：

image::cfdisk-2.png[]

步骤三：

image::cfdisk-3.png[]

==== 格式化分区

格式化系统盘：

[source, bash]
mkfs.ext4 /dev/sda1

格式化虚拟分区：

[source, bash]
----
mkswap /dev/sda2

swapon /dev/sda2
----

==== 挂载分区

[source, bash]
mount /dev/sda1 /mnt

==== 设置国内镜像源

[source, bash]
----
cat << EOF > /etc/pacman.d/mirrorlist
# tsinghua
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/\$repo/os/\$arch
EOF
----

==== 安装基础包

[source, bash]
pacstrap /mnt base

==== 开机挂载分区

[source, bash]
genfstab -U /mnt >> /mnt/etc/fstab

编辑 `/mnt/etc/fstab` 文件，确认分区信息无误。

==== 切换到全新 Arch Linux 系统

[source, bash]
arch-chroot /mnt

==== 设置时区

[source, bash]
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

==== 本地化语言支持

启用语言参数：

[source, bash]
----
echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen
echo "zh_CN.GB18030 GB18030" >> /etc/locale.gen
echo "zh_CN.GBK GBK" >> /etc/locale.gen
echo "zh_CN.UTF-8 UTF-8" >> /etc/locale.gen
echo "zh_CN GB2312" >> /etc/locale.gen
----

生成locale：

[source, bash]
locale-gen

设置系统默认语言：

[source, bash]
echo "LANG=zh_CN.UTF-8" > /etc/locale.conf

==== 键盘布局

[source, bash]
echo "KEYMAP=us" > /etc/vconsole.conf

==== 设置主机名

[source, bash]
----
echo '127.0.0.1 localhost' > /etc/hosts
# 添加主机名对应的设置
echo '127.0.0.1 archlinux' > /etc/hosts
----

==== 设置root密码

[source, bash]
passwd

==== 创建用户

新增用户：

[source, bash]
useradd -m mk

设置用户密码：

[source, bash]
passwd mk

添加到sudo列表：

[source, bash]
----
pacman -S sudo

echo 'mk   ALL=(ALL) ALL' >> /etc/sudoers
----

==== 安装Grub引导

===== 使用传统方式启动的BIOS

[source, bash]
----
pacman -S grub

grub-install /dev/sda

grub-install --target=i386-pc --recheck /dev/sda

pacman -S linux linux-headers linux-lts linux-lts-headers

grub-mkconfig -o /boot/grub/gurb.cfg
----

===== 使用UEFI启动的BIOS

对于使用 UEFI 启动的用户，请用以下方式安装和设置Grub引导：

[source, bash]
----
pacman -S grub efibootmgr

grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=arch

pacman -S linux linux-headers linux-lts linux-lts-headers

grub-mkconfig -o /boot/grub/gurb.cfg
----

==== 安装桌面

[source, bash]
----
# 桌面环境
pacman -S gnome ibus-sunpinyin sunpinyin sunpinyin-data

# WIFI驱动
pacman -S linux-firmware

# 拼音输入法
pacman -S ibus-sunpinyin sunpinyin sunpinyin-data

# 通用显卡驱动
pacman -S xf86-video-fbdev xf86-video-intel xf86-video-vesa

# 汉字字体
pacman wqy-microhei wqy-zenhei 

# 开机启动
systemctl enable NetworkManager
systemctl enable gdm
----

==== 重启

[source, bash]
----
exit

reboot
----

安装完成，重启进入Arch Linux系统。

==== 设置pacman

增加 `Arch Linux 中文社区仓库` 的腾讯镜像服务器：

[source, bash]
----
# 进入root
sudo -i

cat << EOF >> /etc/pacman.conf

[archlinuxcn]
Server = https://mirrors.cloud.tencent.com/archlinuxcn/$arch
SigLevel = Optional TrustAll

EOF

exit
----

`Arch Linux 中文社区仓库` 包含深度QQ、深度TIM、WPS、Google Chrome浏览器、WPS等等不开源的软件。

==== 安装常用软件

在桌面打开终端，复制以下命令一次性安装：

[source, bash]
pacman -S gedit vim screen thunderbird thunderbird-i18n-zh-cn openssh bash-completion cmake git curl wget filezilla gcc make  mlocate  nginx ntp p7zip rsync virtualbox  virtualbox-guest-iso virtualbox-host-dkms file-roller parted sshpass rdesktop qt5 fakeroot google-chrome openssl


==== 系统设置

在桌面打开终端，执行以下命令：

[source, bash]
----
# GNOME 桌面设置
gsettings set org.gnome.nautilus.preferences always-use-location-entry true
gsettings set org.gnome.nautilus.preferences default-sort-order name
gsettings set org.gnome.nautilus.preferences sort-directories-first true
gsettings set org.gnome.desktop.interface clock-show-date true
gsettings set org.gnome.desktop.interface clock-show-seconds true

# virtualbox 设置
sudo gpasswd -a root vboxusers
sudo gpasswd -a $USER vboxusers
sudo grpunconv

# 开机启动
sudo systemctl enable ntpd
sudo systemctl enable sshd
sudo systemctl mask tmp.mount
----


===== gedit 编辑器设置

安装设置编辑器：

[source, bash]
sudo pacman -S dconf-editor

然后，在终端执行 `dconf-editor` 命令后，依次找到菜单 org.gnome.gedit.preferences.editor -> scheme -> cobalt，可以设置编辑器背景。

org.gnome.gedit.preferences.editor 中有许多其它设置，根据自己习惯自行设置。

